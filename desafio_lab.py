# -*- coding: utf-8 -*-
"""Desafio_LAB.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1UWwg_GLQM9W_2HI_CL5Snq-qHoqnH_va

##Visão Geral do Desafio.
####O projeto consiste em uma conciliação do **valor total de vendas** de recarga de celular por *operadora* e *por loja*
####A Bemol recebe um arquivo de uma empresa financeira (*detalhamento.xlsx*) onde possui o valor consolidado de vendas e o objetivo é verificar se os dados do nosso banco de dados (*vendas.csv*) estão de acordo com o informado.

#Dica:
Os dados do SAP vêm separados por cada transição de venda realizada. A ideia é de agrupar esses dados para deixá-los no formato parecido com que recebemos da empresa externa(*detalhamento.xlsx*) e, assim, poder unificar as tabelas e fazer a comparação.
 
##To-Do List:

![image.png](data:image/png;base64,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)

* Leitura de Bases:
"""

import pandas as pd

"""# 1. Leitura de Arquivos."""

df_vendas = pd.read_csv('vendas.csv', sep = '|', skiprows = 0, encoding = 'utf-8')

df_vendas

df_detalhamento = pd.concat(pd.read_excel('detalhamento.xlsx', sheet_name=None, skiprows = 1), ignore_index=True)
#Concatenando os Sheets 'AM' 'RR' 'RO' 'AC' em apenas um Sheet.

df_detalhamento

"""# 2. Tratamento de Dados.

##2.1 Renomeando Colunas
"""

df_detalhamento.columns = ['loja_nome', 'loja_id', 'uf', 'operadora', 'valor_bruto']

df_detalhamento

df_vendas.columns = ['loja_id', 'operadora', 'material', 'data', 'valor_liquido']

df_vendas

"""## 2.2 Verificar Tipos"""

df_detalhamento.dtypes

df_vendas.dtypes

"""##2.3 Deletar Dados."""

df_detalhamento = df_detalhamento[[ 'loja_id', 'operadora', 'valor_bruto']].copy()

df_vendas = df_vendas[['loja_id', 'operadora', 'valor_liquido']].copy()

"""#3. Concatenar Tabelas"""

df_vendas

df_detalhamento

df_vendas = df_vendas.groupby(['loja_id', 'operadora']).agg({'valor_liquido': 'sum'}).reset_index()

df_relatorio = pd.concat([df_vendas, df_detalhamento])

"""![image.png](data:image/png;base64,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)

#4. Correlação de Tabelas.
"""

df_relatorio = df_relatorio.groupby(['loja_id', 'operadora']).agg({'valor_liquido':'first', 'valor_bruto': 'first'}).reset_index()

df_relatorio

"""#5. Regras de Negócio"""

#Comparação sem condicional, para visualizar 'Falso' para valores conformes e 'True' para valores divergentes.
#df_relatorio['status'] = (df_relatorio['valor_liquido'] != df_relatorio['valor_bruto'])

#Utilizando replace para apontar os valores na tabela: 

# replace_dict = {
    #True: "Conforme",
    #False: 'Alerta' }

#Atribundo os valores a tabela 'Status'
# df_relatorio = df_relatorio['status'].replace(replace_dict)

"""Outra maneira:"""

df_relatorio['status'] = df_relatorio['valor_bruto'] - df_relatorio['valor_liquido']

df_relatorio['status'] = df_relatorio['status'].apply(lambda x: 'Conforme!' if x == 0.0 else 'Alerta')

df_relatorio

"""#6. Exportar Dados"""

writer = pd.ExcelWriter('Relatório.xlsx')

df_relatorio.to_excel(writer, sheet_name='relatorio_final', index=False)

writer.save()

